<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å”®åç ”å‘æ§åˆ¶å°</title>
    <style>
        /* --- å…¨å±€æ·±è‰²é»‘å®¢é£æ ·å¼ --- */
        body { 
            background-color: #0d1117; 
            color: #c9d1d9; 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
        }

        /* --- å¤´éƒ¨åŒºåŸŸ --- */
        .header { 
            border-bottom: 1px solid #30363d; 
            padding-bottom: 15px; 
            margin-bottom: 20px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
        }
        .header h1 { 
            margin: 0; 
            font-size: 18px; 
            color: #58a6ff; /* GitHub è“ */
        }

        /* --- æŒ‰é’®ç»„æ ·å¼ --- */
        .header-actions { 
            display: flex; 
            gap: 10px; 
        }
        .btn { 
            text-decoration: none; 
            padding: 6px 12px; 
            border-radius: 6px; 
            font-size: 13px; 
            font-weight: 600; 
            cursor: pointer; 
            transition: 0.2s; 
            display: flex; 
            align-items: center;
            line-height: 20px;
        }
        /* åˆ·æ–°æŒ‰é’® - ç°è‰² */
        .btn-refresh { 
            background-color: #21262d; 
            color: #c9d1d9; 
            border: 1px solid #30363d; 
        }
        .btn-refresh:hover { 
            border-color: #8b949e; 
            background-color: #30363d; 
        }
        /* æéœ€æ±‚æŒ‰é’® - ç»¿è‰² */
        .btn-add { 
            background-color: #238636; 
            color: #ffffff; 
            border: 1px solid rgba(240,246,252,0.1); 
        }
        .btn-add:hover { 
            background-color: #2ea043; 
        }

        /* --- åˆ—è¡¨åŒºåŸŸ --- */
        .issue-list { 
            list-style: none; 
            padding: 0; 
            margin: 0; 
        }
        .issue-item { 
            background-color: #161b22; 
            border: 1px solid #30363d; 
            border-radius: 6px; 
            padding: 16px; 
            margin-bottom: 12px; 
            transition: 0.2s; 
        }
        .issue-item:hover { 
            border-color: #8b949e; 
        }
        .issue-title { 
            font-size: 16px; 
            font-weight: 600; 
            color: #e6edf3; 
            margin-bottom: 8px; 
            display: flex; 
            align-items: center; 
        }
        
        /* --- æ ‡ç­¾ç³»ç»Ÿ --- */
        .labels { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 6px; 
            margin-top: 8px; 
        }
        .label { 
            font-size: 12px; 
            padding: 2px 8px; 
            border-radius: 2em; 
            border: 1px solid transparent; 
            color: #fff; 
            font-weight: 500; 
            /* è®©æ ‡ç­¾æ–‡å­—ç¨å¾®äº®ä¸€ç‚¹ */
            text-shadow: 0 0 1px rgba(0,0,0,0.5); 
        }

        /* --- åº•éƒ¨å…ƒæ•°æ® --- */
        .meta { 
            margin-top: 12px; 
            font-size: 12px; 
            color: #8b949e; 
            display: flex; 
            justify-content: space-between; 
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>ğŸš€ ç ”å‘å®æ—¶çœ‹æ¿</h1>
        <div class="header-actions">
            <a href="https://docs.dingtalk.com/" target="_blank" class="btn btn-add">
                â• æéœ€æ±‚
            </a>
            
            <span onclick="loadIssues()" class="btn btn-refresh">
                ğŸ”„ åˆ·æ–°
            </span>
        </div>
    </div>

    <div id="loading" style="text-align:center; color:#58a6ff; margin-top: 20px;">
        ğŸ“¡ æ­£åœ¨è¿æ¥ GitHub å«æ˜Ÿæ•°æ®...
    </div>
    
    <ul class="issue-list" id="container"></ul>

    <script>
        // âœ… é…ç½®åŒºï¼šä½ çš„ GitHub è´¦å·å’Œä»“åº“
        const owner = 'chengfengsunce'; 
        const repo = 'dashboard'; 

        async function loadIssues() {
            const container = document.getElementById('container');
            const loading = document.getElementById('loading');
            
            // æ¸…ç©ºåˆ—è¡¨å¹¶æ˜¾ç¤ºåŠ è½½ä¸­
            container.innerHTML = ''; 
            loading.style.display = 'block';
            
            try {
                // è¯·æ±‚ GitHub API
                const url = `https://api.github.com/repos/${owner}/${repo}/issues?state=all&sort=updated&direction=desc&per_page=20`;
                const response = await fetch(url);
                
                // å¤„ç† 403 é™æµ
                if (response.status === 403) {
                    loading.innerHTML = 'âš ï¸ è®¿é—®å¤ªå¿«äº†ï¼Œè§¦å‘ GitHub é™æµï¼Œè¯·ç¨åå†è¯•';
                    return;
                }

                const data = await response.json();
                loading.style.display = 'none';

                // å¤„ç†ç©ºæ•°æ®
                if (!Array.isArray(data) || data.length === 0) {
                    container.innerHTML = '<div style="text-align:center; padding:20px; color:#8b949e">æš‚æ— ä»»åŠ¡<br>è¯·å» GitHub Issues æ–°å»ºä»»åŠ¡</div>';
                    return;
                }

                // æ¸²æŸ“åˆ—è¡¨
                data.forEach(issue => {
                    // æ’é™¤ Pull Request
                    if (issue.pull_request) return;

                    const li = document.createElement('li');
                    li.className = 'issue-item';
                    
                    // å¤„ç†å½©è‰²æ ‡ç­¾
                    let labelHtml = '';
                    issue.labels.forEach(lbl => { 
                        const color = '#' + lbl.color;
                        labelHtml += `<span class="label" style="background-color:${color}; border-color:${color}">${lbl.name}</span>`; 
                    });

                    // çŠ¶æ€å›¾æ ‡ (Open=ç»¿, Closed=ç´«)
                    const stateIcon = issue.state === 'open' ? 'ğŸŸ¢' : 'ğŸŸ£';
                    
                    li.innerHTML = `
                        <div class="issue-title">
                            <a href="${issue.html_url}" target="_blank" style="text-decoration:none; color:inherit; display:flex; align-items:center; width:100%">
                                ${stateIcon} <span style="margin-left:8px">${issue.title}</span>
                            </a>
                        </div>
                        <div class="labels">${labelHtml}</div>
                        <div class="meta">
                            <span>#${issue.number}</span>
                            <span>ğŸ•’ ${new Date(issue.updated_at).toLocaleDateString()}</span>
                        </div>
                    `;
                    container.appendChild(li);
                });

            } catch (e) { 
                loading.innerText = 'âŒ åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–é…ç½®'; 
                console.error(e); 
            }
        }
        
        // é¡µé¢åŠ è½½è‡ªåŠ¨è¿è¡Œ
        loadIssues();
    </script>
</body>
</html>
